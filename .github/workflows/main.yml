name: Flutter_Android

on:
  push:
    branches: [main]

jobs:
 build_android:
   runs-on: ubuntu-latest

   steps:
    - name: Checkout the code
      uses: actions/checkout@v2
      
    - name: Setup Java to compile Android project
      uses: actions/setup-java@v1
      with:
        java-version: '12.x'

    - name: Install and set Flutter version
      uses: subosito/flutter-action@v2
      with:
        channel: stable # or: beta, master (or main)
    - run: flutter --version 

    - name: Restore packages
      run: flutter pub get

    - name: Build Android App Bundle
      run: flutter build appbundle --release

    # Debugging step: List contents of the directory
    - name: List Directory Contents
      run: ls -R build/app/outputs/bundle/release/

    - name: Publish Android Artefacts
      uses: actions/upload-artifact@v2
      with:
        name: release-aab-signed
        path: build/app/outputs/bundle/release/*.aab
